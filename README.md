# Chess Move Predictor

Нейросетевая модель для предсказания шахматных ходов по позиции на доске.

## Задача

По любой шахматной позиции в формате FEN предсказать следующий ход:
- **Вход**: позиция на доске (FEN строка)
- **Выход**: список возможных ходов с вероятностями

## Как это работает

1. **Преобразование доски**: FEN → тензор 8×8×12 (каждый тип фигуры - отдельный канал)
2. **Дополнительные признаки**: рокировки, взятие на проходе, количество фигур
3. **Нейросеть**: сверточная сеть с residual блоками
4. **Предсказание**: вероятности для всех возможных ходов

## Метрики качества

После 15 эпох обучения модель показывает:

| Метрика | Значение | Описание |
|---------|----------|-----------|
| **Accuracy@1** | 31.6% | Правильный ход на первом месте |
| **Accuracy@3** | 52.2% | Правильный ход в топ-3 |
| **Accuracy@5** | 62.2% | Правильный ход в топ-5 |
| **Train Loss** | 0.978 | Ошибка на обучающей выборке |
| **Validation Loss** | 3.425 | Ошибка на валидационной выборке |

## Пример:  
#### fen = "rnb2rk1/pp3ppp/4p1n1/q1pP4/3P4/1QN1P1B1/PP3PPP/R3KB1R b KQ - 0 11"  
#### Зеленая стрелка - предсказание модели. Логичный ход и топ-3 по Stockfish 17.1
<img width="430" height="415" alt="image" src="https://github.com/user-attachments/assets/4d8958de-4176-4189-9e01-4e4b993fe6b6" />

## Структура проекта
```bash
chess_neiro_predict/
├── src/                     # Исходный код
│   ├── mymodel.py           # Архитектура нейросети
│   ├── features.py          # Преобразование FEN в тензоры и доп признаки
│   ├── training.py          # Обучение модели
│   └── move.py              # Составление легальных ходов
├── fens_training_set.csv    # Данные
├── notebooks/
│   ├── analys.ipynb         # EDA и проверка функций
│   ├── modeling.ipynb       # Собираем всё воедино
│   └── best_chess_model.pt  # Получившаяся модель
```

В репозитории представлена демо-модель best_chess_model.pt, обученная на уменьшенном наборе данных. Полная версия модели с указанными метриками была обучена на всем датасете в Kaggle.  

## Возможности
- Предсказание ходов для любой позиции  
- Топ-5 рекомендаций с вероятностями  
- Быстрое предсказание (~50 мс на ход)  
- В планах: персональные модели для игроков  

Модель успешно предсказывает сильные шахматные ходы и может использоваться для анализа позиций и помощи в изучении шахмат.

## Будущие улучшения
Подбор оптимальной архитектуры модели и анализ других метрик  
Персональные модели для игроков, чтобы предсказывать ходы конкретного игрока с учетом его стиля:
### Что нужно:
500-1000 партий одного игрока для надежной статистики  
Данные о его типичных дебютах, тактических предпочтениях  
Информация об агрессивности/осторожности стиля  
### Как это будет работать:  
Базовая модель (текущая) - понимает общие шахматные принципы  
Персональный слой - дообучается на ходах конкретного игрока  
Смешанное предсказание = 70% общая логика + 30% стиль игрока  
### Отличия от общей модели:
Учитывает любимые дебюты (например, игрок всегда начинает e2-e4)  
Улавливает тактические предпочтения (жертвы, позиционная игра)  
Помнит типичные ошибки и сильные стороны  



